#This file is part of Vulture OS.
#
#Vulture 3 is free software: you can redistribute it and/or modify
#it under the terms of the GNU General Public License as published by
#the Free Software Foundation, either version 3 of the License, or
#(at your option) any later version.

#Vulture 3 is distributed in the hope that it will be useful,
#but WITHOUT ANY WARRANTY; without even the implied warranty of
#MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#GNU General Public License for more details.

#You should have received a copy of the GNU General Public License
#along with Vulture 3.  If not, see http://www.gnu.org/licenses/.

########################## WARNING ###############################
# Don't edit this file, it is automatically generated by Vulture #
########################## WARNING ###############################



#Local requests
SetEnvIf Remote_Addr {{node.management_ip}} let_me_in=1

SetEnvIf Request_URI "^/netdata/{{node.name}}/.*" let_me_in=1
SetEnvIf Request_URI "^/console/{{node.name}}/.*" let_me_in=1
SetEnvIf Request_URI "^/haproxy-stats/{{node.name}}/.*" let_me_in=1
ProxyPassMatch "^/netdata/{{node.name}}/(.*)" "https://{{node.name}}:8000/netdata/$1" connectiontimeout=5 timeout=30 keepalive=on
ProxyPassMatch "^/console/{{node.name}}/(.*)" "https://{{node.name}}:8000/console/$1" connectiontimeout=5 timeout=30 keepalive=on
ProxyPassMatch "^/haproxy-stats/{{node.name}}/(.*)" "https://{{node.name}}:8000/haproxy-stats/$1" connectiontimeout=5 timeout=30 keepalive=on

#Remote requests
{% for n in nodes %}
SetEnvIf Remote_Addr {{n.management_ip}} let_me_in=1
SetEnvIf Request_URI "^/netdata/{{n.name}}/.*" let_me_in=1
SetEnvIf Request_URI "^/console/{{n.name}}/.*" let_me_in=1
SetEnvIf Request_URI "^/haproxy-stats/{{n.name}}/.*" let_me_in=1
ProxyPassMatch "^/netdata/{{n.name}}/(.*)" "https://{{n.name}}:8000/netdata/$1" connectiontimeout=5 timeout=30 keepalive=on
ProxyPassMatch "^/console/{{n.name}}/(.*)" "https://{{n.name}}:8000/console/$1" connectiontimeout=5 timeout=30 keepalive=on
ProxyPassMatch "^/haproxy-stats/{{n.name}}/(.*)" "https://{{n.name}}:8000/haproxy-stats/$1" connectiontimeout=5 timeout=30 keepalive=on
{% endfor %}
