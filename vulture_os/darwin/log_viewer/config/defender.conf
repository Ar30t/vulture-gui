#This file is part of Vulture OS.
#

########################## WARNING ###############################
# Don't edit this file, it is automatically generated by Vulture #
########################## WARNING ###############################

# Defender toggle
Defender On

# Match log path
MatchLog /var/log/defender/match_{{policy.id}}.log

# JSON Match log path
JSONMatchLog /var/log/defender/json_match_{{policy.id}}.log

# Request body limit
RequestBodyLimit {{ policy.request_body_limit }}

# Learning mode toggle
LearningMode Off

# Extensive Learning log toggle
ExtensiveLog Off

# Libinjection SQL toggle
LibinjectionSQL {{ 'On' if policy.enable_libinjection_sql else 'Off' }}

# Libinjection XSS toggle
LibinjectionXSS {{ 'On' if policy.enable_libinjection_xss else 'Off' }}

# Rules
Include /usr/local/etc/defender.d/core.rules

# Score action
CheckRule "$SQL >= 8" BLOCK
CheckRule "$RFI >= 8" BLOCK
CheckRule "$TRAVERSAL >= 4" BLOCK
CheckRule "$EVADE >= 4" BLOCK
CheckRule "$XSS >= 8" BLOCK
CheckRule "$UPLOAD >= 8" BLOCK

# Whitelists
{{ruleset.raw_rules}}

